CREATE VIEW TotalSummaryConsortium AS
SELECT SumConsortiumUsage.TRLN_Year, SumConsortiumUsage.Total_COUNTER_JanJun, SumConsortiumUsage.Total_COUNTER_JulDec, SumConsortiumUsage.Total_COUNTER__AllMonths, SumConsortiumCount.CountSubs, SumConsortiumCosts.Total_TRLN_Cost, SumConsortiumCosts.Total_PUB_Price, SumConsortiumCosts.Discount_Total_Consortium, SumConsortiumCosts.Discount_Percentage_Consortium, ROUND(Total_TRLN_Cost/Total_COUNTER__AllMonths, 2) AS CostPerUse_Consortium, ROUND(Total_TRLN_Cost/CountSubs, 2) AS CostPerTitle_Consortium, ROUND(Total_COUNTER__AllMonths/CountSubs, 2) AS UsePerTitle_Consortium, SumConsortiumUsage.SERSOL_ProvName
FROM SumConsortiumCount INNER JOIN (SumConsortiumUsage INNER JOIN SumConsortiumCosts ON (SumConsortiumUsage.TRLN_Year = SumConsortiumCosts.TRLN_Year) AND (SumConsortiumUsage.SERSOL_ProvName = SumConsortiumCosts.SERSOL_ProvName)) ON (SumConsortiumCount.TRLN_Year = SumConsortiumCosts.TRLN_Year) AND (SumConsortiumCount.SERSOL_ProvName = SumConsortiumCosts.SERSOL_ProvName)
ORDER BY SumConsortiumUsage.TRLN_Year DESC;
