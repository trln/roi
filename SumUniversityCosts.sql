CREATE VIEW SumUniversityCosts AS
SELECT loc_TRLN_Universities.TRLN_UniversityName, loc_TRLN_Costs.TRLN_Year, ROUND(Sum(loc_TRLN_Costs.TRLN_Cost), 2) AS Total_TRLN_Cost, ROUND(Sum(loc_PUB_Prices.PUB_Price), 2) AS Total_PUB_Price, ROUND((Sum(loc_PUB_Prices.PUB_Price)-Sum(loc_TRLN_Costs.TRLN_Cost)), 2) AS Discount_Total_University, TRUNCATE(ROUND(((Sum(loc_PUB_Prices.PUB_Price)-Sum(loc_TRLN_Costs.TRLN_Cost))/Sum(loc_PUB_Prices.PUB_Price)), 4) * 100, 2) AS Discount_Percentage_University, loc_SERSOL_Providers.SERSOL_ProvName
FROM loc_SERSOL_Providers INNER JOIN (loc_TRLN_Universities INNER JOIN (loc_TRLN_Libraries INNER JOIN (loc_SERSOL_Databases INNER JOIN (loc_PUB_Titles INNER JOIN (loc_PUB_Prices INNER JOIN loc_TRLN_Costs ON loc_PUB_Prices.TRLN_Year = loc_TRLN_Costs.TRLN_Year) ON (loc_PUB_Titles.PUB_ISSNL = loc_TRLN_Costs.PUB_ISSNL) AND (loc_PUB_Titles.PUB_ISSNL = loc_PUB_Prices.PUB_ISSNL)) ON loc_SERSOL_Databases.SERSOL_DBCode = loc_TRLN_Costs.SERSOL_DBCode) ON loc_TRLN_Libraries.TRLN_LibraryID = loc_TRLN_Costs.TRLN_LibraryID) ON loc_TRLN_Universities.TRLN_UniversityID = loc_TRLN_Libraries.TRLN_UniversityID) ON loc_SERSOL_Providers.SERSOL_ProvID = loc_SERSOL_Databases.SERSOL_ProvID
GROUP BY loc_TRLN_Universities.TRLN_UniversityName, loc_TRLN_Costs.TRLN_Year, loc_SERSOL_Providers.SERSOL_ProvName;