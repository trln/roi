CREATE VIEW TotalSummaryLibrary AS
SELECT SumLibraryUsage.TRLN_LibraryName, SumLibraryUsage.TRLN_Year, SumLibraryUsage.Total_COUNTER_JanJun, SumLibraryUsage.Total_COUNTER_JulDec, SumLibraryUsage.Total_COUNTER__AllMonths, SumLibraryCount.CountSubs, SumLibraryCosts.Total_TRLN_Cost, SumLibraryCosts.Total_PUB_Price, SumLibraryCosts.Discount_Total_Library, SumLibraryCosts.Discount_Percentage_Library, ROUND(Total_TRLN_Cost/Total_COUNTER__AllMonths, 2) AS CostPerUse_Library, ROUND(Total_TRLN_Cost/CountSubs, 2) AS CostPerTitle_Library, ROUND(Total_COUNTER__AllMonths/CountSubs, 0) AS UsePerTitle_Library, SumLibraryUsage.SERSOL_ProvName
FROM SumLibraryCount INNER JOIN (SumLibraryUsage INNER JOIN SumLibraryCosts ON (SumLibraryUsage.TRLN_Year = SumLibraryCosts.TRLN_Year) AND (SumLibraryUsage.TRLN_LibraryName = SumLibraryCosts.TRLN_LibraryName) AND (SumLibraryUsage.SERSOL_ProvName = SumLibraryCosts.SERSOL_ProvName)) ON (SumLibraryCount.TRLN_Year = SumLibraryCosts.TRLN_Year) AND (SumLibraryCount.TRLN_LibraryName = SumLibraryCosts.TRLN_LibraryName) AND (SumLibraryCount.SERSOL_ProvName = SumLibraryCosts.SERSOL_ProvName);
